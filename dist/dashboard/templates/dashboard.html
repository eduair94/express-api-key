<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Key Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{{cssPath}}">
  <script>
    tailwind.config = {
      darkMode: ['class', '[data-theme="dark"]'],
      theme: {
        extend: {
          colors: {
            primary: {
              DEFAULT: '#6366f1',
              dark: '#4f46e5',
              light: '#818cf8'
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-100 min-h-screen font-sans antialiased transition-colors duration-200" data-theme="light">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    
    <!-- Header -->
    <header class="flex flex-wrap items-center justify-between gap-4 mb-8 animate-fade-in">
      <h1 class="text-2xl sm:text-3xl font-bold flex items-center gap-3">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" />
        </svg>
        API Key Dashboard
      </h1>
      <div class="flex items-center gap-3">
        <button id="themeToggle" class="flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors focus-ring">
          <svg class="sun-icon w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
          </svg>
          <span class="theme-text">Light</span>
        </button>
        <a href="{{logoutPath}}" class="flex items-center gap-2 px-4 py-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-sm text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors focus-ring">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15M12 9l-3 3m0 0l3 3m-3-3h12.75" />
          </svg>
          Logout
        </a>
      </div>
    </header>

    <!-- Main API Key Card -->
    <div class="mb-6 animate-fade-in stagger-1">
      <div class="gradient-primary rounded-2xl p-6 sm:p-8 text-white shadow-xl">
        <div class="flex flex-wrap items-start justify-between gap-4">
          <div>
            <p class="text-indigo-200 text-sm uppercase tracking-wide font-medium">Your API Key</p>
            <h2 class="text-2xl sm:text-3xl font-bold mt-1">{{role}}</h2>
            <p class="text-indigo-200 mt-1">
              Role • 
              <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium {{keyStatusBadgeClass}}">
                <span class="w-2 h-2 rounded-full bg-current animate-pulse-dot"></span>
                {{keyStatusText}}
              </span>
            </p>
          </div>
          <div class="p-3 bg-white/20 rounded-xl">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
            </svg>
          </div>
        </div>
        <div class="mt-6 flex items-center gap-3 p-4 bg-white/10 rounded-xl font-mono-key">
          <code id="apiKey" class="flex-1 text-sm sm:text-base truncate">{{key}}</code>
          <button id="copyBtn" class="p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors tooltip" data-tooltip="Copy to clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Stats Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6">
      
      <!-- Usage Card -->
      <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 card-hover animate-fade-in stagger-1">
        <div class="flex items-start justify-between mb-4">
          <div class="p-3 bg-slate-100 dark:bg-slate-700 rounded-xl">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
            </svg>
          </div>
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium {{usageStatusBadgeClass}}">
            <span class="w-1.5 h-1.5 rounded-full bg-current animate-pulse-dot"></span>
            {{usageStatusText}}
          </span>
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide font-medium">Monthly Usage</p>
        <p class="text-3xl font-bold mt-1">{{requestCountMonth}}</p>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">{{remaining}} remaining</p>
        <div class="mt-4">
          <div class="flex justify-between text-xs text-slate-500 dark:text-slate-400 mb-2">
            <span>{{usagePercent}}% used</span>
            <span>{{monthlyCap}} limit</span>
          </div>
          <div class="h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden">
            <div class="h-full rounded-full transition-all duration-1000 {{progressBarClass}}" style="width: {{usagePercent}}%"></div>
          </div>
        </div>
      </div>

      <!-- Renewal Card -->
      <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 card-hover animate-fade-in stagger-2">
        <div class="p-3 bg-slate-100 dark:bg-slate-700 rounded-xl w-fit mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
          </svg>
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide font-medium">Quota Resets In</p>
        <p class="text-3xl font-bold mt-1">{{renewalDaysDisplay}} <span class="text-lg font-normal text-slate-400">days</span></p>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">{{renewalDateDisplay}}</p>
      </div>

      <!-- Expiration Card -->
      <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 card-hover animate-fade-in stagger-3">
        <div class="flex items-start justify-between mb-4">
          <div class="p-3 bg-slate-100 dark:bg-slate-700 rounded-xl">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          {{keyExpiringSoonBadge}}
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide font-medium">Key Expires In</p>
        <p class="text-3xl font-bold mt-1">{{keyExpiresDaysDisplay}}</p>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">{{keyExpiresDateDisplay}}</p>
      </div>

      <!-- Rate Limit Card -->
      <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 card-hover animate-fade-in stagger-4">
        <div class="p-3 bg-slate-100 dark:bg-slate-700 rounded-xl w-fit mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
          </svg>
        </div>
        <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide font-medium">Rate Limit</p>
        <p class="text-3xl font-bold mt-1">{{minIntervalSeconds}}<span class="text-lg font-normal text-slate-400">s</span></p>
        <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">Min interval between requests</p>
      </div>
    </div>

    <!-- Details Section -->
    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 mb-6 animate-fade-in">
      <h3 class="text-lg font-semibold flex items-center gap-2 mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
        </svg>
        Detailed Information
      </h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl">
          <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide">Last Used</p>
          <p class="font-medium mt-1">{{lastUsedAtDisplay}}</p>
        </div>
        <div class="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl">
          <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide">Billing Cycle Started</p>
          <p class="font-medium mt-1">{{requestCountStartDisplay}}</p>
        </div>
        <div class="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl">
          <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide">Key Validity Period</p>
          <p class="font-medium mt-1">{{daysValidDisplay}}</p>
        </div>
        <div class="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-xl">
          <p class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide">Created At</p>
          <p class="font-medium mt-1">{{createdAtDisplay}}</p>
        </div>
      </div>
      {{allowedEndpointsSection}}
    </div>

    <!-- Insights Section -->
    <div class="bg-white dark:bg-slate-800 rounded-xl p-6 border border-slate-200 dark:border-slate-700 mb-6 animate-fade-in">
      <h3 class="text-lg font-semibold flex items-center gap-2 mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18" />
        </svg>
        Insights & Recommendations
      </h3>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        {{insightsContent}}
      </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-6 text-sm text-slate-500 dark:text-slate-400">
      Powered by <a href="https://github.com/eduair94/express-api-key" target="_blank" class="text-indigo-500 hover:text-indigo-600 transition-colors">express-api-key</a> • Last updated: {{lastUpdated}}
    </footer>
  </div>

  <script>
    // Theme toggle
    const themeToggle = document.getElementById('themeToggle');
    const themeText = document.querySelector('.theme-text');
    
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      document.body.classList.toggle('dark', theme === 'dark');
      themeText.textContent = theme === 'dark' ? 'Dark' : 'Light';
      localStorage.setItem('dashboard-theme', theme);
    }
    
    themeToggle.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    });
    
    // Load saved theme
    const savedTheme = localStorage.getItem('dashboard-theme') || 
      (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    setTheme(savedTheme);

    // Copy API key
    document.getElementById('copyBtn').addEventListener('click', async function() {
      const apiKey = document.getElementById('apiKey').textContent;
      await navigator.clipboard.writeText(apiKey);
      
      this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg>';
      this.setAttribute('data-tooltip', 'Copied!');
      
      setTimeout(() => {
        this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184" /></svg>';
        this.setAttribute('data-tooltip', 'Copy to clipboard');
      }, 2000);
    });

    // Animate progress bar on load
    document.addEventListener('DOMContentLoaded', () => {
      const progressBar = document.querySelector('[style*="width:"]');
      if (progressBar) {
        const width = progressBar.style.width;
        progressBar.style.width = '0';
        requestAnimationFrame(() => {
          progressBar.style.width = width;
        });
      }
    });
  </script>
</body>
</html>
